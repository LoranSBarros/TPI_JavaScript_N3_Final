<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de Vendas</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        function adicionarProduto() {
            const tabela = document.getElementById("produtos");
            const novaLinha = tabela.insertRow();
            novaLinha.innerHTML = `
                <td><input type="text" placeholder="Produto" required></td>
                <td><input type="number" placeholder="Quantidade" required></td>
                <td><input type="text" placeholder="Preço Unitário (R$)" oninput="mascaraReais(this)" required></td>
                <td><button type="button" onclick="excluirProduto(this)" style="background-color: red; color: white; border: none; padding: 5px;">Excluir</button></td>
            `;
        }

        function excluirProduto(botao) {
            const linha = botao.parentNode.parentNode;
            linha.remove();
        }

        function mascaraReais(input) {
            let valor = input.value.replace(/\D/g, "");
            valor = (valor / 100).toFixed(2) + "";
            valor = valor.replace(".", ",");
            input.value = "R$ " + valor;
        }

        function mascaraCEP(input) {
            let cep = input.value.replace(/\D/g, "");
            cep = cep.replace(/(\d{5})(\d)/, "$1-$2");
            input.value = cep;
        }

        function atualizarCidades() {
            const cidadesPorEstado = {
                SP: ["São Paulo", "Campinas", "Santos", "Sorocaba", "Ribeirão Preto"],
                RJ: ["Rio de Janeiro", "Niterói", "Petrópolis", "Cabo Frio", "Volta Redonda"],
                MG: ["Belo Horizonte", "Uberlândia", "Juiz de Fora", "Contagem", "Betim"]
            };

            const estado = document.getElementById("estado").value;
            const cidadeSelect = document.getElementById("cidade");

            cidadeSelect.innerHTML = "<option value=''>Selecione...</option>";

            if (estado && cidadesPorEstado[estado]) {
                cidadesPorEstado[estado].forEach(cidade => {
                    const option = document.createElement("option");
                    option.value = cidade;
                    option.textContent = cidade;
                    cidadeSelect.appendChild(option);
                });
            }
        }

        function validarCliente(event) {
            event.preventDefault();
            const nome = document.getElementById("cliente").value.trim();
            const email = document.getElementById("email").value.trim();
            const cep = document.getElementById("cep").value.trim();

            if (nome.split(" ").length < 2) {
                alert("O nome do cliente deve conter pelo menos duas palavras.");
                return false;
            }

            if (!email.includes("@") || !email.split("@")[1].includes(".")) {
                alert("Por favor, insira um e-mail válido.");
                return false;
            }

            if (cep.length !== 9 || !/^\d{5}-\d{3}$/.test(cep)) {
                alert("Por favor, insira um CEP válido (formato: 00000-000).");
                return false;
            }

            alert("Pedido registrado com sucesso. Correções e informações sobre o pagamento deverão chegar pelo email em breve. Agradecemos a preferência!");
        }
    </script>
</head>
<body>
    <nav style="background-color: #0337e4; color: #fff; padding: 10px; text-align: center;">
        <a href="loja_de_instrumentos.html" style="color: #fff; text-decoration: none; font-size: 18px;">Início</a>
    </nav>

    <main style="padding: 20px; font-family: Arial, sans-serif;">
        <h1>Cadastro de Vendas</h1>
        <form onsubmit="validarCliente(event)">
            <label for="cliente">Nome do Cliente:</label>
            <input type="text" id="cliente" required style="width: 100%; padding: 8px; margin: 10px 0;"><br>

            <label for="email">E-mail:</label>
            <input type="email" id="email" required style="width: 100%; padding: 8px; margin: 10px 0;"><br>

            <label for="cep">CEP:</label>
            <input type="text" id="cep" placeholder="00000-000" maxlength="9" oninput="mascaraCEP(this)" required style="width: 100%; padding: 8px; margin: 10px 0;"><br>

            <label for="endereco1">Linha de Endereço 1:</label>
            <input type="text" id="endereco1" required style="width: 100%; padding: 8px; margin: 10px 0;"><br>

            <label for="endereco2">Linha de Endereço 2 (opcional):</label>
            <input type="text" id="endereco2" style="width: 100%; padding: 8px; margin: 10px 0;"><br>

            <label for="estado">Estado:</label>
            <select id="estado" onchange="atualizarCidades()" required style="width: 100%; padding: 8px; margin: 10px 0;">
                <option value="">Selecione...</option>
                <option value="SP">São Paulo</option>
                <option value="RJ">Rio de Janeiro</option>
                <option value="MG">Minas Gerais</option>
            </select><br>

            <label for="cidade">Cidade:</label>
            <select id="cidade" required style="width: 100%; padding: 8px; margin: 10px 0;">
                <option value="">Selecione um estado primeiro...</option>
            </select><br>

            <label>Produtos:</label>
            <table id="produtos" border="1" style="width: 100%; margin-bottom: 10px;">
                <tr>
                    <th>Produto</th>
                    <th>Quantidade</th>
                    <th>Preço Unitário (R$)</th>
                    <th>Ação</th>
                </tr>
            </table>
            <button type="button" onclick="adicionarProduto()" style="background-color: #010264; color: #fff; padding: 10px; border: none; cursor: pointer;">Adicionar Produto</button><br><br>

            <button type="submit" style="background-color: #010264; color: #fff; padding: 10px 20px; border: none; cursor: pointer;">Finalizar Venda</button>
        </form>
    </main>
</body>
</html>
